(function(){function require(path,parent,orig){var resolved=require.resolve(path);if(null==resolved){orig=orig||path;parent=parent||"root";var err=new Error('Failed to require "'+orig+'" from "'+parent+'"');err.path=orig;err.parent=parent;err.require=true;throw err}var module=require.modules[resolved];if(!module._resolving&&!module.exports){var mod={};mod.exports={};mod.client=mod.component=true;module._resolving=true;module.call(this,mod.exports,require.relative(resolved),mod);delete module._resolving;module.exports=mod.exports}return module.exports}require.modules={};require.aliases={};require.resolve=function(path){if(path.charAt(0)==="/")path=path.slice(1);var paths=[path,path+".js",path+".json",path+"/index.js",path+"/index.json"];for(var i=0;i<paths.length;i++){var path=paths[i];if(require.modules.hasOwnProperty(path))return path;if(require.aliases.hasOwnProperty(path))return require.aliases[path]}};require.normalize=function(curr,path){var segs=[];if("."!=path.charAt(0))return path;curr=curr.split("/");path=path.split("/");for(var i=0;i<path.length;++i){if(".."==path[i]){curr.pop()}else if("."!=path[i]&&""!=path[i]){segs.push(path[i])}}return curr.concat(segs).join("/")};require.register=function(path,definition){require.modules[path]=definition};require.alias=function(from,to){if(!require.modules.hasOwnProperty(from)){throw new Error('Failed to alias "'+from+'", it does not exist')}require.aliases[to]=from};require.relative=function(parent){var p=require.normalize(parent,"..");function lastIndexOf(arr,obj){var i=arr.length;while(i--){if(arr[i]===obj)return i}return-1}function localRequire(path){var resolved=localRequire.resolve(path);return require(resolved,parent,path)}localRequire.resolve=function(path){var c=path.charAt(0);if("/"==c)return path.slice(1);if("."==c)return require.normalize(p,path);var segs=parent.split("/");var i=lastIndexOf(segs,"deps")+1;if(!i)i=0;path=segs.slice(0,i+1).join("/")+"/deps/"+path;return path};localRequire.exists=function(path){return require.modules.hasOwnProperty(localRequire.resolve(path))};return localRequire};require.register("component-emitter/index.js",function(exports,require,module){module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks[event]=this._callbacks[event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){var self=this;this._callbacks=this._callbacks||{};function on(){self.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks[event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks[event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}});require.register("component-bind/index.js",function(exports,require,module){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn)fn=obj[fn];if("function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}});require.register("pay-with-amazon/index.js",function(exports,require,module){"use strict";var Emitter=require("emitter");var bind=require("bind");module.exports=PayWithAmazon;function PayWithAmazon(opts){if(!(this instanceof PayWithAmazon))return new PayWithAmazon(opts);this.configure(opts);this.billingAgreementId=null;this.consent=undefined;this.widgets={};this._status=this.status();this.setBillingAgreementId=bind(this,this.setBillingAgreementId);this.initWallet=bind(this,this.initWallet);this.initConsent=bind(this,this.initConsent);this.setConsent=bind(this,this.setConsent);this.error=bind(this,this.error);this.init=bind(this,this.init);if("window.OffAmazonPayments"in window){this.init()}else{document.write('<script src="'+"https://static-na.payments-amazon.com/OffAmazonPayments"+"/us/sandbox/js/Widgets.js?sellerId="+this.config.sellerId+'"></script>');window.onAmazonLoginReady=this.init}return this}Emitter(PayWithAmazon.prototype);PayWithAmazon.prototype.configure=function(opts){if(typeof opts!=="object")throw new Error("opts must be provided as an object.");if(!opts.sellerId)throw new Error("opts.sellerId is required.");if(!opts.clientId)throw new Error("opts.clientId is required.");if(!opts.button)throw new Error("opts.button is required.");if(!opts.wallet)throw new Error("opts.wallet is required.");if(!opts.consent)throw new Error("opts.consent is required.");if(typeof opts.button==="string")opts.button={id:opts.button};if(typeof opts.wallet==="string")opts.wallet={id:opts.wallet};if(typeof opts.consent==="string")opts.consent={id:opts.consent};if(typeof opts.addressBook==="string")opts.addressBook={id:opts.addressBook};opts.button.type=opts.button.type==="small"?"Pay":"PwA";opts.button.color=opts.button.color||"Gold";opts.wallet.width=(opts.wallet.width||400)+"px";opts.wallet.height=(opts.wallet.height||260)+"px";opts.consent.width=(opts.consent.width||400)+"px";opts.consent.height=(opts.consent.height||140)+"px";if(opts.addressBook){opts.addressBook.width=(opts.addressBook.width||400)+"px";opts.addressBook.height=(opts.addressBook.height||260)+"px"}this.config=opts};PayWithAmazon.prototype.init=function(){window.amazon.Login.setClientId(this.config.clientId);var self=this;var pollId=setInterval(poll,200);function poll(){if(!window.OffAmazonPayments.Button)return;clearTimeout(pollId);self.initButton()}};PayWithAmazon.prototype.status=function(){var id=this.billingAgreementId;var consent=this.consent;var status={};if(!id){status.error="Billing agreement ID has not been set."}if(consent!==undefined){status.consent=consent}if(consent===undefined){status.error="Billing consent not yet given."}else if(!consent){status.error="Billing consent not given."}if(!status.error){status.id=id}return status};PayWithAmazon.prototype.check=function(){var status=this.status();if(JSON.stringify(status)!==JSON.stringify(this._status)){this._status=status;this.emit("change",status)}};PayWithAmazon.prototype.initButton=function(){var self=this;var type=this.config.button.type;var color=this.config.button.color;this.widgets.button=new window.OffAmazonPayments.Button(this.config.button.id,this.config.sellerId,{type:type,color:color,authorization:function(){var opts={scope:"profile payments:widget payments:shipping_address",popup:true};window.amazon.Login.authorize(opts,function(res){if(res.error)return self.error(res.error);self.initAddressBook()})},onError:this.error})};PayWithAmazon.prototype.initAddressBook=function(){if(!this.config.addressBook)return this.initWallet();var opts={agreementType:"BillingAgreement",sellerId:this.config.sellerId,onReady:this.setBillingAgreementId,onAddressSelect:this.initWallet,design:{size:this.config.addressBook},onError:this.error};this.widgets.addressBook=new window.OffAmazonPayments.Widgets.AddressBook(opts);this.widgets.addressBook.bind(this.config.addressBook.id)};PayWithAmazon.prototype.initWallet=function(){var self=this;var opts={amazonBillingAgreementId:this.billingAgreementId,sellerId:this.config.sellerId,design:{size:this.config.wallet},onPaymentSelect:function(){self.initConsent();self.check()},onError:this.error};if(!this.billingAgreementId){opts.agreementType="BillingAgreement";opts.onReady=this.setBillingAgreementId}this.widgets.wallet=new window.OffAmazonPayments.Widgets.Wallet(opts);this.widgets.wallet.bind(this.config.wallet.id)};PayWithAmazon.prototype.initConsent=function(){var opts={amazonBillingAgreementId:this.billingAgreementId,sellerId:this.config.sellerId,design:{size:this.config.consent},onReady:this.setConsent,onConsent:this.setConsent,onError:this.error};this.widgets.consent=new window.OffAmazonPayments.Widgets.Consent(opts);this.widgets.consent.bind(this.config.consent.id)};PayWithAmazon.prototype.setBillingAgreementId=function(ref){this.billingAgreementId=ref.getAmazonBillingAgreementId();this.check()};PayWithAmazon.prototype.setConsent=function(consentStatus){if(typeof consentStatus.getConsentStatus==="undefined")return;this.consent=consentStatus.getConsentStatus()==="true";this.check()};PayWithAmazon.prototype.error=function(err){var error={code:err.getErrorCode(),message:err.getErrorMessage()};if(console){if(Error.captureStackTrace){Error.captureStackTrace(error,this.error)}console.error(error)}this.emit("error",error)}});require.alias("component-emitter/index.js","pay-with-amazon/deps/emitter/index.js");require.alias("component-emitter/index.js","emitter/index.js");require.alias("component-bind/index.js","pay-with-amazon/deps/bind/index.js");require.alias("component-bind/index.js","bind/index.js");require.alias("pay-with-amazon/index.js","pay-with-amazon/index.js");if(typeof exports=="object"){module.exports=require("pay-with-amazon")}else if(typeof define=="function"&&define.amd){define([],function(){return require("pay-with-amazon")})}else{this["PayWithAmazon"]=require("pay-with-amazon")}})();